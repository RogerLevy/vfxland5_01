\ =============================================================================
\ Create classes from bitmaps automatically
\ =============================================================================

: create-autoclass ( a n - )
    \ Takes a bitmap filename
    -path | n a |
    a n s" png" ext? -exit
    a n -ext f" %%%s" >pad find nip if
        \ a n 2dup -ext f" %%%s >template [[ %s bmp ! ]]" .evaluate
        exit
    then 
    \ ." Creating auto-class from bitmap " a n type cr
    push-order only forth definitions
    a n -ext f" class: %%%s %%actor derive autoclass on" .evaluate
    a n f"     template [[ %s bmp ! ]]" .evaluate
    s" class;" .evaluate
    \ a n -ext 2dup f" aka _%s %%%s" .evaluate
    pop-order ;

: create-autoclasses
    ." Creating autoclasses..." cr
    s" gfx" >datadir dir-exists? -exit
    push-order
        s" gfx" >datadir
        ['] create-autoclass each-file
    pop-order ;
