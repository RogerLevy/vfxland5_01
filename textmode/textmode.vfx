library: textmode_renderer.dll

extern "C" void draw_textmode_buffers( void * font, void * chars,
    void * fg_colors, void * bg_colors, int cols, int rows, float x, float y, float line_spacing );  \ "

fast[

8192 ?constant /char-buf
create char-buf  /char-buf allot&erase
create fg-buf    /char-buf cells allot&erase
create bg-buf    /char-buf cells allot&erase

|| 0 value pos
|| 0 value #cols
|| 0 value #rows

: textmode-draw ( #cols #rows f: x f: y - )
    2>r builtin-font char-buf fg-buf bg-buf 2r> 4e draw_textmode_buffers ;

: textmode-dim ( #cols #rows - )
    to #rows to #cols ;

: textmode-clear ( - )
    #rows #cols * {: #chars :}
    char-buf #chars erase
    fg-buf #chars cells erase
    bg-buf #chars cells erase 
    0 to pos ;

: textmode-write ( c fgc bgc - )
    bg-buf pos cells + !
    fg-buf pos cells + !
    char-buf pos + c! 
    pos 1 + 8191 and to pos ;

: textmode-locate ( col row - )
    #cols * + 8191 and to pos ;

fast]